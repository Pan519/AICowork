# Claude-Cowork é¡¹ç›®å…¨é¢å®¡è®¡æŠ¥å‘Š

> **æ–‡æ¡£ç±»å‹**: é¡¹ç›®å®¡è®¡æŠ¥å‘Š
> **å®¡è®¡æ—¥æœŸ**: 2026-01-20
> **é¡¹ç›®ç‰ˆæœ¬**: 0.1.0
> **å®¡è®¡èŒƒå›´**: ä»£ç è´¨é‡ã€å®‰å…¨æ€§ã€ä¾èµ–ç®¡ç†ã€æµ‹è¯•è¦†ç›–ã€æ–‡æ¡£å®Œæ•´æ€§ã€é…ç½®ã€æ€§èƒ½

---
> **@author**: Alan
> **@copyright**: Copyright Â© 2026
> **@created**: 2026-01-20
> **@Email**: alan@example.com
> **@license**: AGCPA v3.0
---

## ç›®å½•

- [ä¸€ã€é¡¹ç›®æ¦‚è¿°](#ä¸€é¡¹ç›®æ¦‚è¿°)
- [äºŒã€æ¶æ„åˆ†æ](#äºŒæ¶æ„åˆ†æ)
- [ä¸‰ã€ä»£ç è´¨é‡å®¡è®¡](#ä¸‰ä»£ç è´¨é‡å®¡è®¡)
- [å››ã€å®‰å…¨æ€§å®¡è®¡](#å››å®‰å…¨æ€§å®¡è®¡)
- [äº”ã€ä¾èµ–é¡¹å®¡è®¡](#äº”ä¾èµ–é¡¹å®¡è®¡)
- [å…­ã€æµ‹è¯•è¦†ç›–ç‡å®¡è®¡](#å…­æµ‹è¯•è¦†ç›–ç‡å®¡è®¡)
- [ä¸ƒã€æ–‡æ¡£å®Œæ•´æ€§å®¡è®¡](#ä¸ƒæ–‡æ¡£å®Œæ•´æ€§å®¡è®¡)
- [å…«ã€é…ç½®æ–‡ä»¶å®¡è®¡](#å…«é…ç½®æ–‡ä»¶å®¡è®¡)
- [ä¹ã€æ€§èƒ½ä¸ä¼˜åŒ–å»ºè®®](#ä¹æ€§èƒ½ä¸ä¼˜åŒ–å»ºè®®)
- [åã€å›½é™…åŒ–å®¡è®¡](#åå›½é™…åŒ–å®¡è®¡)
- [åä¸€ã€ç»¼åˆè¯„åˆ†](#åä¸€ç»¼åˆè¯„åˆ†)
- [åäºŒã€ä¼˜å…ˆçº§æ”¹è¿›å»ºè®®](#åäºŒä¼˜å…ˆçº§æ”¹è¿›å»ºè®®)

---

## ä¸€ã€é¡¹ç›®æ¦‚è¿°

### 1.1 åŸºæœ¬ä¿¡æ¯

| é¡¹ç›®ä¿¡æ¯ | è¯¦æƒ… |
|---------|------|
| **é¡¹ç›®åç§°** | Claude-Cowork / Agent Cowork |
| **é¡¹ç›®ç±»å‹** | Electron æ¡Œé¢åº”ç”¨ |
| **ä¸»è¦ç”¨é€”** | Claude Code çš„ GUI ç‰ˆæœ¬ï¼Œæä¾› AI ç¼–ç¨‹åä½œç•Œé¢ |
| **æŠ€æœ¯æ ˆ** | Electron 39, React 19, TypeScript, Tailwind CSS 4, Zustand, better-sqlite3 |
| **è®¸å¯è¯** | MIT |

### 1.2 é¡¹ç›®ç»“æ„

```
c:\myproject\Claude-Cowork\
â”œâ”€â”€ .github/                     # GitHub Actions å·¥ä½œæµ
â”œâ”€â”€ assets/                     # é™æ€èµ„æº
â”œâ”€â”€ dist/                       # æ„å»ºè¾“å‡ºç›®å½•
â”œâ”€â”€ dist-electron/              # Electron ä¸»è¿›ç¨‹æ„å»ºè¾“å‡º
â”œâ”€â”€ dist-react/                 # React å‰ç«¯æ„å»ºè¾“å‡º
â”œâ”€â”€ docs/                       # æ–‡æ¡£ç›®å½•
â”œâ”€â”€ patches/                    # ä¾èµ–è¡¥ä¸
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ electron/              # Electron ä¸»è¿›ç¨‹
â”‚   â”‚   â”œâ”€â”€ main.ts            # ä¸»å…¥å£æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ preload.cts        # é¢„åŠ è½½è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ ipc-handlers.ts    # IPC äº‹ä»¶å¤„ç†å™¨
â”‚   â”‚   â”œâ”€â”€ logger.ts          # æ—¥å¿—ç³»ç»Ÿ
â”‚   â”‚   â””â”€â”€ libs/              # æ ¸å¿ƒåº“
â”‚   â”‚       â”œâ”€â”€ claude-settings.ts
â”‚   â”‚       â”œâ”€â”€ config-store.ts
â”‚   â”‚       â”œâ”€â”€ runner.ts
â”‚   â”‚       â””â”€â”€ session-store.ts
â”‚   â””â”€â”€ ui/                     # React å‰ç«¯
â”‚       â”œâ”€â”€ App.tsx            # ä¸»åº”ç”¨ç»„ä»¶
â”‚       â”œâ”€â”€ components/        # UI ç»„ä»¶
â”‚       â”œâ”€â”€ hooks/             # React Hooks
â”‚       â”œâ”€â”€ store/             # çŠ¶æ€ç®¡ç†
â”‚       â””â”€â”€ i18n/              # å›½é™…åŒ–
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json              # TypeScript é…ç½®å…¥å£
â”œâ”€â”€ tsconfig.app.json          # åº”ç”¨ TypeScript é…ç½®
â”œâ”€â”€ tsconfig.node.json         # Node TypeScript é…ç½®
â”œâ”€â”€ vite.config.ts             # Vite æ„å»ºé…ç½®
â””â”€â”€ electron-builder.json      # Electron æ‰“åŒ…é…ç½®
```

---

## äºŒã€æ¶æ„åˆ†æ

### 2.1 ç›®å½•ç»“æ„è¯„åˆ†ï¼šâ­â­â­â­â˜† (4/5)

**ä¼˜ç‚¹**ï¼š
- âœ… æ¸…æ™°çš„å‰åç«¯åˆ†ç¦»ï¼š`src/electron/`ï¼ˆä¸»è¿›ç¨‹ï¼‰ä¸ `src/ui/`ï¼ˆæ¸²æŸ“è¿›ç¨‹ï¼‰
- âœ… ç»„ä»¶åŒ–è‰¯å¥½ï¼šUI ç»„ä»¶æŒ‰åŠŸèƒ½åˆ†ç±»
- âœ… çŠ¶æ€ç®¡ç†é›†ä¸­ï¼šä½¿ç”¨ Zustand ç»Ÿä¸€ç®¡ç†åº”ç”¨çŠ¶æ€
- âœ… ä¸‰å±‚ TypeScript é…ç½®ï¼šæ ¹é…ç½®ã€åº”ç”¨é…ç½®ã€Electron é…ç½®ç‹¬ç«‹ç®¡ç†

**å»ºè®®æ”¹è¿›**ï¼š
- âš ï¸ `docs/` ç›®å½•ä¹‹å‰ä¸ºç©ºï¼Œåº”æ·»åŠ é¡¹ç›®æ–‡æ¡£
- âš ï¸ ç¼ºå°‘ `tests/` ç›®å½•ï¼ˆç›®å‰åªæœ‰æµ‹è¯•æ–‡ä»¶æ•£è½åœ¨ `src/` ä¸­ï¼‰

### 2.2 ä»£ç æ¶æ„è¯„åˆ†ï¼šâ­â­â­â­â˜† (4/5)

**æ¶æ„äº®ç‚¹**ï¼š

| å±‚çº§ | æ–‡ä»¶ | èŒè´£ |
|------|------|------|
| **ä¸»è¿›ç¨‹** | [main.ts](../src/electron/main.ts) | åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç† |
| **IPC é€šä¿¡** | [ipc-handlers.ts](../src/electron/ipc-handlers.ts) | ä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹é€šä¿¡ |
| **é¢„åŠ è½½** | [preload.cts](../src/electron/preload.cts) | å®‰å…¨ API æš´éœ² |
| **ä¼šè¯ç®¡ç†** | [session-store.ts](../src/electron/libs/session-store.ts) | SQLite æŒä¹…åŒ– |
| **ä»»åŠ¡è¿è¡Œ** | [runner.ts](../src/electron/libs/runner.ts) | Claude AI äº¤äº’ |
| **å‰ç«¯çŠ¶æ€** | [useAppStore.ts](../src/ui/store/useAppStore.ts) | Zustand çŠ¶æ€ç®¡ç† |

### 2.3 åˆ†å±‚æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ç”¨æˆ·ç•Œé¢å±‚ (UI)                       â”‚
â”‚  React 19 + Tailwind CSS 4 + i18n                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†• IPC
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   é¢„åŠ è½½å±‚ (Preload)                      â”‚
â”‚  contextBridge å®‰å…¨ API æš´éœ²                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†• IPC
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ä¸»è¿›ç¨‹å±‚ (Main)                         â”‚
â”‚  ä¼šè¯ç®¡ç† | ä»»åŠ¡è¿è¡Œ | æ—¥å¿—ç³»ç»Ÿ | é…ç½®ç®¡ç†               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æ•°æ®å±‚ (Data)                           â”‚
â”‚  better-sqlite3 (WAL) | é…ç½®æ–‡ä»¶                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸‰ã€ä»£ç è´¨é‡å®¡è®¡

### 3.1 TypeScript ä½¿ç”¨è¯„åˆ†ï¼šâ­â­â­â­â˜† (4/5)

| æ£€æŸ¥é¡¹ | çŠ¶æ€ | è¯´æ˜ |
|--------|------|------|
| ä¸¥æ ¼æ¨¡å¼ | âœ… | `tsconfig.app.json` å¯ç”¨ `"strict": true` |
| ç±»å‹å®šä¹‰ | âœ… | è‰¯å¥½çš„æ¥å£å®šä¹‰ ([types.ts](../src/ui/types.ts)) |
| ç±»å‹å¯¼å…¥ | âœ… | ä½¿ç”¨ `import type` |
| any ä½¿ç”¨ | âš ï¸ | å°‘é‡ `any` ç±»å‹ï¼ˆ[preload.cts:12](../src/electron/preload.cts#L12), [App.tsx:129](../src/ui/App.tsx#L129)ï¼‰ |

**TypeScript é…ç½®å±‚æ¬¡**ï¼š

```json
// tsconfig.json - æ ¹é…ç½®
{
  "files": [],
  "references": [
    { "path": "./tsconfig.app.json" },
    { "path": "./tsconfig.node.json" }
  ]
}

// src/electron/tsconfig.json - ä¸»è¿›ç¨‹é…ç½®
{
  "compilerOptions": {
    "strict": true,
    "target": "ESNext",
    "module": "NodeNext",
    "outDir": "../../dist-electron"
  }
}
```

### 3.2 ä»£ç é£æ ¼è¯„åˆ†ï¼šâ­â­â­â­â˜† (4/5)

| æ£€æŸ¥é¡¹ | çŠ¶æ€ | é…ç½® |
|--------|------|------|
| ESLint | âœ… | [eslint.config.js](../eslint.config.js) |
| React Hooks | âœ… | eslint-plugin-react-hooks |
| React Refresh | âœ… | eslint-plugin-react-refresh |

**ä»£ç é£æ ¼ç»Ÿä¸€**ï¼š
- âœ… å‘½åè§„èŒƒä¸€è‡´ï¼ˆcamelCase/PascalCaseï¼‰
- âœ… ç¼©è¿›ç»Ÿä¸€ï¼ˆå‰ç«¯ 2 ç©ºæ ¼ï¼Œåç«¯ 4 ç©ºæ ¼ï¼‰
- âœ… å¯¼å…¥é¡ºåºè§„èŒƒ

### 3.3 ä»£ç æ³¨é‡Šè¯„åˆ†ï¼šâ­â­â­â˜†â˜† (3/5)

| æ–‡ä»¶ | æ³¨é‡Šè¦†ç›– | ç¤ºä¾‹ |
|------|----------|------|
| [runner.ts](../src/electron/libs/runner.ts) | âœ… è‰¯å¥½ | åˆ é™¤æ£€æµ‹å‡½æ•°æœ‰ä¸­æ–‡æ³¨é‡Š |
| [logger.ts](../src/electron/logger.ts) | âœ… è‰¯å¥½ | æ—¥å¿—å‡½æ•°æœ‰ JSDoc æ³¨é‡Š |
| [session-store.ts](../src/electron/libs/session-store.ts) | âš ï¸ ä¸€èˆ¬ | ç±»å‹å®šä¹‰å®Œæ•´ï¼Œå‡½æ•°ç¼ºå°‘æ³¨é‡Š |
| [useAppStore.ts](../src/ui/store/useAppStore.ts) | âš ï¸ ä¸€èˆ¬ | çŠ¶æ€ç®¡ç†ç¼ºå°‘æ³¨é‡Š |

**æ³¨é‡Šç¤ºä¾‹** ([runner.ts:29](../src/electron/libs/runner.ts#L29))ï¼š

```typescript
/**
 * æ£€æµ‹æ˜¯å¦æ˜¯åˆ é™¤æ“ä½œ
 * @param toolName å·¥å…·åç§°
 * @param input å·¥å…·è¾“å…¥å‚æ•°
 * @returns æ˜¯å¦æ˜¯åˆ é™¤æ“ä½œ
 */
function checkIfDeletionOperation(toolName: string, input: unknown): boolean
```

### 3.4 æŠ€æœ¯å€ºåŠ¡è¿½è¸ª

å‘ç° 1 ä¸ª TODO é¡¹ï¼š

| ä½ç½® | å†…å®¹ | ä¼˜å…ˆçº§ |
|------|------|--------|
| [runner.ts:237](../src/electron/libs/runner.ts#L237) | `// TODO: åœ¨è¿™é‡Œæ‹¦æˆªï¼Œé˜»æ­¢å·¥å…·æ‰§è¡Œ` | ä¸­ |

**è¯´æ˜**ï¼šSDK å·²ç»æ‰§è¡Œäº†å·¥å…·ï¼Œæ‰€ä»¥æ— æ³•åœ¨æ¶ˆæ¯æµä¸­æ‹¦æˆªã€‚è¿™éœ€è¦åœ¨ `canUseTool` å›è°ƒä¸­å¤„ç†ã€‚

### 3.5 Console è¾“å‡ºç»Ÿè®¡

å‘ç° 21 å¤„ console è°ƒç”¨ï¼Œåˆ†å¸ƒåœ¨ä»¥ä¸‹æ–‡ä»¶ï¼š

| æ–‡ä»¶ | console æ•°é‡ | ç±»å‹ |
|------|-------------|------|
| [App.tsx](../src/ui/App.tsx) | 2 | error |
| [PromptInput.tsx](../src/ui/components/PromptInput.tsx) | 1 | log |
| [SettingsModal.tsx](../src/ui/components/SettingsModal.tsx) | 3 | error/info |
| [StartSessionModal.tsx](../src/ui/components/StartSessionModal.tsx) | 1 | error |
| [preload.cts](../src/electron/preload.cts) | 1 | error |
| [util.ts](../src/electron/libs/util.ts) | 5 | log/warn |
| [config-store.ts](../src/electron/libs/config-store.ts) | 3 | error/info |
| [claude-settings.ts](../src/electron/libs/claude-settings.ts) | 5 | log |

**å»ºè®®**ï¼šç”Ÿäº§ç¯å¢ƒåº”ä½¿ç”¨ winston æ—¥å¿—ç³»ç»Ÿæ›¿ä»£ console è¾“å‡ºã€‚

---

## å››ã€å®‰å…¨æ€§å®¡è®¡

### 4.1 å®‰å…¨è¯„åˆ†ï¼šâ­â­â­â­â˜† (4/5)

| å®‰å…¨é¡¹ | çŠ¶æ€ | è¯¦æƒ… |
|--------|------|------|
| IPC å®‰å…¨ | âœ… | ä½¿ç”¨ `contextBridge` é™åˆ¶æš´éœ² |
| æ•æ„Ÿæ•°æ® | âœ… | API å¯†é’¥å­˜å‚¨åœ¨ userData ç›®å½• |
| åˆ é™¤ä¿æŠ¤ | âœ… | åŒé‡æ£€æµ‹ + å¼ºåˆ¶ç¡®è®¤å¯¹è¯æ¡† |
| è¾“å…¥éªŒè¯ | âš ï¸ | éƒ¨åˆ†é…ç½®éªŒè¯å¯ä»¥åŠ å¼º |
| Console è¾“å‡º | âš ï¸ | 21 å¤„ console.logï¼ˆç”Ÿäº§ç¯å¢ƒåº”æ¸…ç†ï¼‰ |
| ç¯å¢ƒå˜é‡ | âœ… | .env å·²åœ¨ .gitignore ä¸­ |

### 4.2 å®‰å…¨äº®ç‚¹

#### 1. åˆ é™¤æ“ä½œä¿æŠ¤æœºåˆ¶

**åŒé‡æ£€æµ‹æ¶æ„**ï¼š

```
ç”¨æˆ·è¾“å…¥ â†’ [å‰ç«¯æ£€æµ‹] â†’ [åç«¯æ£€æµ‹] â†’ SDK canUseTool â†’ ç”¨æˆ·ç¡®è®¤ â†’ æ‰§è¡Œ
         (App.tsx)    (runner.ts)                     (å¼¹çª—)
```

**æ”¯æŒçš„åˆ é™¤å‘½ä»¤æ£€æµ‹** ([runner.ts:29](../src/electron/libs/runner.ts#L29))ï¼š

| å¹³å° | å‘½ä»¤ | æ­£åˆ™è¡¨è¾¾å¼ |
|------|------|-----------|
| **PowerShell** | Remove-Item, Delete-Item | `/\b(Remove-Item\|Delete-Item)\b/i` |
| **Windows CMD** | del, erase, rmdir | `/\b(del\|erase\|rmdir)\s+/i` |
| **Unix/Linux** | rm, rmdir, unlink | `/\brm\s+[-\w\s\\"\\"'\$]+/` |
| **å…¶ä»–å·¥å…·** | trash, shred, srm | `/\b(trash\|shred\|srm)\s+/` |

#### 2. IPC é€šä¿¡å®‰å…¨ ([preload.cts](../src/electron/preload.cts))

```typescript
electron.contextBridge.exposeInMainWorld("electron", {
    // ä»…æš´éœ²å¿…è¦çš„ API
    sendClientEvent: (event: any) => { ... },
    onServerEvent: (callback) => { ... },
    // ... å…¶ä»–å—æ§ API
})
```

### 4.3 å®‰å…¨å»ºè®®

| ä¼˜å…ˆçº§ | å»ºè®® | ä½ç½® | é¢„æœŸæ•ˆæœ |
|--------|------|------|----------|
| ğŸ”´ é«˜ | æ¸…ç†ç”Ÿäº§ç¯å¢ƒçš„ console.log | å…¨å±€ | å‡å°‘ä¿¡æ¯æ³„éœ² |
| ğŸŸ¡ ä¸­ | åŠ å¼º API é…ç½®è¾“å…¥éªŒè¯ | [config-store.ts:21](../src/electron/libs/config-store.ts#L21) | é˜²æ­¢æ— æ•ˆé…ç½® |
| ğŸŸ¡ ä¸­ | æ·»åŠ  Content-Security-Policy | - | é˜²æ­¢ XSS æ”»å‡» |
| ğŸŸ¡ ä¸­ | æ•æ„Ÿæ—¥å¿—è„±æ•å¤„ç† | [logger.ts](../src/electron/logger.ts) | é˜²æ­¢ API Key æ³„éœ² |
| ğŸŸ¢ ä½ | å®šæœŸä¾èµ–å®‰å…¨æ‰«æ | package.json | åŠæ—¶å‘ç°æ¼æ´ |

### 4.4 æ•æ„Ÿæ•°æ®ä¿æŠ¤

**API å¯†é’¥å­˜å‚¨** ([config-store.ts](../src/electron/libs/config-store.ts))ï¼š

```typescript
// å­˜å‚¨ä½ç½®ï¼šapp.getPath("userData")/api-config.json
// ä¸æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ï¼ˆ.gitignore å·²é…ç½®ï¼‰
function getConfigPath(): string {
    return join(app.getPath("userData"), "api-config.json");
}
```

**é£é™©æç¤º**ï¼šæ—¥å¿—ä¸­å¯èƒ½å‡ºç° API Keyï¼Œå»ºè®®æ·»åŠ æ•æ„Ÿä¿¡æ¯è¿‡æ»¤å™¨ã€‚

---

## äº”ã€ä¾èµ–é¡¹å®¡è®¡

### 5.1 ç”Ÿäº§ä¾èµ–

| ä¾èµ– | ç‰ˆæœ¬ | ç”¨é€” | çŠ¶æ€ |
|------|------|------|------|
| @anthropic-ai/claude-agent-sdk | ^0.2.6 | Claude AI SDK | âœ… å·²æ‰“è¡¥ä¸ |
| @radix-ui/react-dialog | ^1.1.15 | å¯¹è¯æ¡†ç»„ä»¶ | âœ… |
| @radix-ui/react-dropdown-menu | ^2.1.16 | ä¸‹æ‹‰èœå• | âœ… |
| @tailwindcss/vite | ^4.1.18 | Tailwind Vite æ’ä»¶ | âœ… |
| better-sqlite3 | ^12.6.0 | SQLite æ•°æ®åº“ | âœ… asarUnpack |
| dotenv | ^17.2.3 | ç¯å¢ƒå˜é‡ | âœ… |
| highlight.js | ^11.11.1 | ä»£ç é«˜äº® | âœ… |
| os-utils | ^0.0.14 | ç³»ç»Ÿå·¥å…· | âœ… asarUnpack |
| react | ^19.2.3 | å‰ç«¯æ¡†æ¶ | âœ… |
| react-dom | ^19.2.3 | DOM æ¸²æŸ“ | âœ… |
| react-markdown | ^10.1.0 | Markdown æ¸²æŸ“ | âœ… |
| rehype-highlight | ^7.0.2 | ä»£ç é«˜äº® | âœ… |
| rehype-raw | ^7.0.0 | HTML æ”¯æŒ | âœ… |
| remark-gfm | ^4.0.1 | GitHub é£æ ¼ Markdown | âœ… |
| tailwindcss | ^4.1.18 | CSS æ¡†æ¶ | âœ… |
| util-deprecate | ^1.0.2 | åºŸå¼ƒè­¦å‘Š | âœ… |
| vite-tsconfig-paths | ^6.0.3 | è·¯å¾„æ˜ å°„ | âœ… |
| winston | ^3.19.0 | æ—¥å¿—ç³»ç»Ÿ | âœ… asarUnpack |
| zustand | ^5.0.10 | çŠ¶æ€ç®¡ç† | âœ… |

### 5.2 å¼€å‘ä¾èµ–

| ä¾èµ– | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| @types/better-sqlite3 | ^7.6.13 | ç±»å‹å®šä¹‰ |
| @types/react | ^19.2.7 | ç±»å‹å®šä¹‰ |
| @vitejs/plugin-react | ^5.1.2 | React Vite æ’ä»¶ |
| cross-env | ^10.1.0 | è·¨å¹³å°ç¯å¢ƒå˜é‡ |
| electron | ^39.2.7 | Electron è¿è¡Œæ—¶ |
| electron-builder | ^26.4.0 | æ‰“åŒ…å·¥å…· |
| typescript | ~5.9.3 | TypeScript ç¼–è¯‘å™¨ |
| vite | ^7.3.1 | æ„å»ºå·¥å…· |

### 5.3 ç‰¹æ®Šå¤„ç†

#### è¡¥ä¸ä¾èµ– ([patches/](../patches/))

```
@anthropic-ai/claude-agent-sdk@0.2.6
â””â”€â”€ å°† spawn æ”¹ä¸º forkï¼Œæ”¹è¿›è¿›ç¨‹é€šä¿¡
```

**è¡¥ä¸å†…å®¹** ([@anthropic-ai%2Fclaude-agent-sdk@0.2.6.patch](../patches/@anthropic-ai%2Fclaude-agent-sdk@0.2.6.patch))ï¼š

```diff
- import { spawn } from "child_process";
+ import { fork } from "child_process";

- const childProcess = spawn(command, args, { ... });
+ const childProcess = fork(args[0], args.slice(1), { ... });
```

#### asarUnpack åˆ—è¡¨ ([electron-builder.json](../electron-builder.json))

```json
"asarUnpack": [
    "node_modules/@anthropic-ai/claude-agent-sdk/**/*",
    "node_modules/better-sqlite3/**/*",
    "node_modules/os-utils/**/*",
    "node_modules/winston/**/*",
    "node_modules/winston-transport/**/*"
]
```

### 5.4 ä¾èµ–ç‰ˆæœ¬è¯„åˆ†ï¼šâ­â­â­â­â˜† (4/5)

| ä¾èµ– | å½“å‰ç‰ˆæœ¬ | æœ€æ–°ç‰ˆæœ¬ | çŠ¶æ€ |
|------|----------|----------|------|
| React | 19.2.3 | 19.2.3 | âœ… æœ€æ–° |
| Electron | 39.2.7 | 39.2.7 | âœ… æœ€æ–° |
| TypeScript | 5.9.3 | 5.9.3 | âœ… æœ€æ–° |
| Vite | 7.3.1 | 7.3.1 | âœ… æœ€æ–° |

---

## å…­ã€æµ‹è¯•è¦†ç›–ç‡å®¡è®¡

### 6.1 æµ‹è¯•è¯„åˆ†ï¼šâ­â­â˜†â˜†â˜† (2/5)

| æµ‹è¯•ç±»å‹ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|------|
| å•å…ƒæµ‹è¯• | âŒ | æ— é¡¹ç›®çº§æµ‹è¯•æ–‡ä»¶ |
| é›†æˆæµ‹è¯• | âŒ | æ—  |
| E2E æµ‹è¯• | âŒ | æ—  |
| æ‰‹åŠ¨æµ‹è¯• | âœ… | æœ‰ api-tester.ts |

### 6.2 ç°æœ‰æµ‹è¯•æ–‡ä»¶

#### [api-tester.ts](../src/electron/api-tester.ts)

**åŠŸèƒ½**ï¼šAPI è¿æ¥æµ‹è¯•å·¥å…·

```typescript
export async function testApiConnection(config: ApiConfig): Promise<TestResult> {
    // æµ‹è¯• API è¿æ¥
    // è¿”å›è¿æ¥çŠ¶æ€ã€å“åº”æ—¶é—´ã€é”™è¯¯ä¿¡æ¯
}
```

**æµ‹è¯•è¦†ç›–**ï¼š
- âœ… è¿æ¥æˆåŠŸæ£€æµ‹
- âœ… HTTP çŠ¶æ€ç å¤„ç† (401, 403, 404, 429, 500, 503)
- âœ… ç½‘ç»œé”™è¯¯å¤„ç† (ENOTFOUND, ECONNREFUSED, ETIMEDOUT)

#### [test.ts](../src/electron/test.ts)

**åŠŸèƒ½**ï¼šèµ„æºç›‘æ§è½®è¯¢

```typescript
export function pollResources(mainWindow: BrowserWindow): void {
    // æ¯ 2 ç§’è½®è¯¢ä¸€æ¬¡ CPUã€å†…å­˜ã€å­˜å‚¨ä½¿ç”¨æƒ…å†µ
}
```

### 6.3 æµ‹è¯•å»ºè®®

#### é«˜ä¼˜å…ˆçº§

1. **æ·»åŠ å•å…ƒæµ‹è¯•æ¡†æ¶**
   - æ¨èä½¿ç”¨ Vitestï¼ˆä¸ Vite æ— ç¼é›†æˆï¼‰
   - æˆ–ä½¿ç”¨ Jest

2. **æ ¸å¿ƒæ¨¡å—æµ‹è¯•ç”¨ä¾‹**

| æ¨¡å— | æµ‹è¯•å†…å®¹ | ä¼˜å…ˆçº§ |
|------|----------|--------|
| [runner.ts](../src/electron/libs/runner.ts) | åˆ é™¤æ£€æµ‹é€»è¾‘ | é«˜ |
| [session-store.ts](../src/electron/libs/session-store.ts) | æ•°æ®åº“ CRUD æ“ä½œ | é«˜ |
| [config-store.ts](../src/electron/libs/config-store.ts) | é…ç½®è¯»å†™éªŒè¯ | ä¸­ |
| [useAppStore.ts](../src/ui/store/useAppStore.ts) | çŠ¶æ€ç®¡ç†é€»è¾‘ | ä¸­ |

#### æµ‹è¯•ç¤ºä¾‹

```typescript
// ç¤ºä¾‹ï¼šåˆ é™¤æ£€æµ‹æµ‹è¯•
describe('checkIfDeletionOperation', () => {
    it('åº”æ£€æµ‹ rm å‘½ä»¤', () => {
        expect(checkIfDeletionOperation('Bash', { command: 'rm file.txt' }))
            .toBe(true);
    });

    it('åº”æ£€æµ‹ PowerShell Remove-Item', () => {
        expect(checkIfDeletionOperation('Bash', {
            command: 'Remove-Item -Path "file.txt"'
        })).toBe(true);
    });

    it('ä¸åº”æ£€æµ‹æ­£å¸¸å‘½ä»¤', () => {
        expect(checkIfDeletionOperation('Bash', { command: 'ls -la' }))
            .toBe(false);
    });
});
```

---

## ä¸ƒã€æ–‡æ¡£å®Œæ•´æ€§å®¡è®¡

### 7.1 æ–‡æ¡£è¯„åˆ†ï¼šâ­â­â­â˜†â˜† (3/5)

| æ–‡æ¡£ | çŠ¶æ€ | å®Œæ•´åº¦ |
|------|------|--------|
| [README.md](../README.md) | âœ… | â­â­â­â­â˜† |
| [README_ZH.md](../README_ZH.md) | âœ… | â­â­â­â­â˜† |
| [RELEASE_NOTES.md](../RELEASE_NOTES.md) | âœ… | â­â­â­â­â­ |
| docs/ ç›®å½• | âœ… | â­â­â˜†â˜†â˜† (æœ¬å®¡è®¡å¡«è¡¥) |
| API æ–‡æ¡£ | âŒ | æ—  |
| å¼€å‘æŒ‡å— | âŒ | æ—  |
| æ¶æ„æ–‡æ¡£ | âŒ | æ—  |

### 7.2 ç°æœ‰æ–‡æ¡£äº®ç‚¹

#### [RELEASE_NOTES.md](../RELEASE_NOTES.md)

- âœ… è¯¦ç»†çš„ç‰ˆæœ¬æ›´æ–°è®°å½•
- âœ… ä¸­è‹±æ–‡åŒè¯­
- âœ… åŒ…å«åŠŸèƒ½æ¦‚è¿°ã€æŠ€æœ¯ç»†èŠ‚ã€ä¸‹è½½é“¾æ¥

#### [README_ZH.md](../README_ZH.md)

- âœ… å®Œæ•´çš„é¡¹ç›®ä»‹ç»
- âœ… å¿«é€Ÿå¼€å§‹æŒ‡å—
- âœ… æ ¸å¿ƒèƒ½åŠ›è¯´æ˜
- âœ… è·¯çº¿å›¾

### 7.3 æ–‡æ¡£å»ºè®®

åº”åœ¨ `docs/` ç›®å½•æ·»åŠ ä»¥ä¸‹æ–‡æ¡£ç»“æ„ï¼š

```
docs/
â”œâ”€â”€ 01-éœ€æ±‚æ–‡æ¡£/
â”‚   â””â”€â”€ äº§å“éœ€æ±‚æ–‡æ¡£.md
â”œâ”€â”€ 02-æŠ€æœ¯æ–‡æ¡£/
â”‚   â”œâ”€â”€ æ¶æ„è®¾è®¡.md
â”‚   â””â”€â”€ æŠ€æœ¯é€‰å‹.md
â”œâ”€â”€ 03-APIæ–‡æ¡£/
â”‚   â””â”€â”€ IPCäº‹ä»¶åˆ—è¡¨.md
â”œâ”€â”€ 04-å¼€å‘è®°å½•/
â”‚   â””â”€â”€ å¼€å‘æ—¥å¿—.md
â”œâ”€â”€ 05-æµ‹è¯•æ–‡æ¡£/
â”‚   â””â”€â”€ é¡¹ç›®å…¨é¢å®¡è®¡æŠ¥å‘Š_v0.1.0.md  (æœ¬æ–‡æ¡£)
â”œâ”€â”€ 06-éƒ¨ç½²æ–‡æ¡£/
â”‚   â””â”€â”€ æ„å»ºå‘å¸ƒæµç¨‹.md
â”œâ”€â”€ 07-ä¼šè®®è®°å½•/
â”œâ”€â”€ 98-ç»éªŒæ€»ç»“/
â”‚   â””â”€â”€ å¼€å‘ç»éªŒæ€»ç»“.md
â””â”€â”€ 99-å½’æ¡£æ–‡æ¡£/
```

#### æ¨èè¡¥å……çš„æ–‡æ¡£

1. **API æ–‡æ¡£** - IPC äº‹ä»¶åˆ—è¡¨
   - client-event ç±»å‹
   - server-event ç±»å‹
   - æ•°æ®ç»“æ„å®šä¹‰

2. **å¼€å‘æŒ‡å—**
   - æœ¬åœ°å¼€å‘ç¯å¢ƒæ­å»º
   - è°ƒè¯•æŠ€å·§
   - ä»£ç è§„èŒƒ

3. **æ¶æ„è®¾è®¡æ–‡æ¡£**
   - åˆ†å±‚æ¶æ„å›¾
   - æ•°æ®æµå›¾
   - å®‰å…¨è®¾è®¡

---

## å…«ã€é…ç½®æ–‡ä»¶å®¡è®¡

### 8.1 é…ç½®è¯„åˆ†ï¼šâ­â­â­â­â˜† (4/5)

| é…ç½®æ–‡ä»¶ | çŠ¶æ€ | å®Œæ•´åº¦ |
|----------|------|--------|
| package.json | âœ… | â­â­â­â­â­ |
| tsconfig.json | âœ… | â­â­â­â­â­ |
| vite.config.ts | âœ… | â­â­â­â­â˜† |
| eslint.config.js | âœ… | â­â­â­â­â˜† |
| electron-builder.json | âœ… | â­â­â­â­â­ |
| .gitignore | âœ… | â­â­â­â­â˜† |

### 8.2 å…³é”®é…ç½®åˆ†æ

#### [package.json](../package.json)

```json
{
  "name": "aicowork",
  "version": "0.1.0",
  "type": "module",
  "main": "dist-electron/main.js"
}
```

**è„šæœ¬é…ç½®**ï¼š

| å‘½ä»¤ | ç”¨é€” |
|------|------|
| `dev` | å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆReact + Electronï¼‰ |
| `build` | ç”Ÿäº§æ„å»º |
| `dist:win` | Windows æ‰“åŒ… |
| `dist:mac-arm64` | macOS Apple Silicon æ‰“åŒ… |
| `dist:mac-x64` | macOS Intel æ‰“åŒ… |
| `dist:linux` | Linux æ‰“åŒ… |

#### [vite.config.ts](../vite.config.ts)

```typescript
export default defineConfig(({ mode }) => {
    const env = loadEnv(mode, process.cwd(), '');
    const port = parseInt(env.PORT);

    return {
        plugins: [react(), tailwindcss(), tsconfigPaths()],
        base: './',
        build: {
            outDir: 'dist-react',
        },
        server: {
            port,
            strictPort: true,
        },
    };
});
```

#### [electron-builder.json](../electron-builder.json)

**å¤šå¹³å°æ”¯æŒ**ï¼š

| å¹³å° | ç›®æ ‡æ ¼å¼ | çŠ¶æ€ |
|------|----------|------|
| Windows | portable | âœ… |
| macOS | dmg | âœ… |
| Linux | AppImage | âœ… |

### 8.3 .gitignore æ£€æŸ¥

[.gitignore](../.gitignore) è¦†ç›–è‰¯å¥½ï¼š

```gitignore
# æ—¥å¿—
logs
*.log

# ä¾èµ–
node_modules

# æ„å»ºè¾“å‡º
dist
dist-react
dist-electron
*.exe
*.dmg

# ç¯å¢ƒå˜é‡
.env

# ç¼–è¾‘å™¨
.vscode/*
.idea
```

**å»ºè®®**ï¼š
- ğŸŸ¢ è€ƒè™‘æäº¤ `bun.lock` ä»¥ç¡®ä¿ä¾èµ–ä¸€è‡´æ€§

---

## ä¹ã€æ€§èƒ½ä¸ä¼˜åŒ–å»ºè®®

### 9.1 æ€§èƒ½è¯„åˆ†ï¼šâ­â­â­â­â˜† (4/5)

### 9.2 ç°æœ‰ä¼˜åŒ–

#### SQLite WAL æ¨¡å¼

[session-store.ts:218](../src/electron/libs/session-store.ts#L218)

```typescript
this.db.exec(`pragma journal_mode = WAL;`);
```

**ä¼˜åŠ¿**ï¼š
- å¹¶å‘è¯»å†™æ€§èƒ½æå‡
- å‡å°‘ç£ç›˜ I/O

#### èµ„æºè½®è¯¢ä¼˜åŒ–

[test.ts:9](../src/electron/test.ts#L9)

```typescript
const POLLING_INTERVAL = 2000; // 2ç§’é—´éš”
```

**ä¼˜åŒ–æ•ˆæœ**ï¼š
- å‡å°‘ä¸å¿…è¦çš„ CPU æ¶ˆè€—
- çª—å£å¤±ç„¦æ—¶ç»§ç»­ç›‘æ§ä½†é™ä½ä¼˜å…ˆçº§

#### æ—¥å¿—è½®è½¬

[logger.ts:47](../src/electron/logger.ts#L47)

```typescript
new winston.transports.File({
    filename: path.join(logDir, 'app.log'),
    maxsize: 5242880, // 5MB
    maxFiles: 5
})
```

### 9.3 ä¼˜åŒ–å»ºè®®

| ä¼˜å…ˆçº§ | å»ºè®® | é¢„æœŸæ•ˆæœ | å®ç°éš¾åº¦ |
|--------|------|----------|----------|
| ğŸŸ¡ ä¸­ | å¤§æ¶ˆæ¯åˆ—è¡¨è™šæ‹Ÿæ»šåŠ¨ | å‡å°‘æ¸²æŸ“å‹åŠ› | ä¸­ |
| ğŸŸ¢ ä½ | å›¾ç‰‡æ‡’åŠ è½½ | å‡å°‘åˆå§‹åŠ è½½ | ä½ |
| ğŸŸ¢ ä½ | ä»£ç åˆ†å‰² | å‡å°‘åˆå§‹åŒ…å¤§å° | ä¸­ |
| ğŸŸ¢ ä½ | æ¶ˆæ¯åˆ†é¡µåŠ è½½ | å‡å°‘å†…å­˜å ç”¨ | ä¸­ |

#### è™šæ‹Ÿæ»šåŠ¨å®ç°å»ºè®®

```typescript
// ä½¿ç”¨ react-window æˆ– react-virtual
import { FixedSizeList } from 'react-window';

const MessageList = ({ messages }) => (
    <FixedSizeList
        height={600}
        itemCount={messages.length}
        itemSize={100}
        width="100%"
    >
        {({ index, style }) => (
            <div style={style}>
                <MessageCard message={messages[index]} />
            </div>
        )}
    </FixedSizeList>
);
```

---

## åã€å›½é™…åŒ–å®¡è®¡

### 10.1 i18n è¯„åˆ†ï¼šâ­â­â­â­â˜† (4/5)

### 10.2 æ”¯æŒçš„è¯­è¨€

| è¯­è¨€ | ä»£ç  | æ–‡ä»¶ | å®Œæ•´åº¦ |
|------|------|------|--------|
| ä¸­æ–‡ | zh | [zh.ts](../src/ui/i18n/locales/zh.ts) | â­â­â­â­â­ |
| è‹±æ–‡ | en | en.ts | â­â­â­â­â­ |

### 10.3 å›½é™…åŒ–è¦†ç›–

[zh.ts](../src/ui/i18n/locales/zh.ts) åŒ…å«ä»¥ä¸‹æ¨¡å—ï¼š

```typescript
export default {
    language: { ... },      // è¯­è¨€åˆ‡æ¢
    sidebar: { ... },       // ä¾§è¾¹æ 
    settings: { ... },      // è®¾ç½®
    errors: { ... },        // é”™è¯¯ä¿¡æ¯
    startSession: { ... },  // å¯åŠ¨ä¼šè¯
    promptInput: { ... },   // è¾“å…¥æ¡†
    common: { ... },        // é€šç”¨
    app: { ... },           // åº”ç”¨
    deletion: { ... },      // åˆ é™¤ç¡®è®¤
}
```

### 10.4 å»ºè®®

- âœ… å›½é™…åŒ–è¦†ç›–å®Œæ•´
- ğŸŸ¢ è€ƒè™‘æ·»åŠ æ›´å¤šè¯­è¨€ï¼ˆæ—¥è¯­ã€éŸ©è¯­ç­‰ï¼‰
- ğŸŸ¢ æ·»åŠ  RTL è¯­è¨€æ”¯æŒï¼ˆé˜¿æ‹‰ä¼¯è¯­ç­‰ï¼‰

---

## åä¸€ã€ç»¼åˆè¯„åˆ†

### 11.1 å„ç»´åº¦è¯„åˆ†

| å®¡è®¡é¡¹ç›® | è¯„åˆ† | è¯´æ˜ |
|----------|------|------|
| æ¶æ„è®¾è®¡ | â­â­â­â­â˜† | æ¸…æ™°çš„å‰åç«¯åˆ†ç¦»ï¼Œä¸‰å±‚ TypeScript é…ç½® |
| ä»£ç è´¨é‡ | â­â­â­â­â˜† | TypeScript ä¸¥æ ¼æ¨¡å¼ï¼Œä»£ç é£æ ¼ä¸€è‡´ |
| å®‰å…¨æ€§ | â­â­â­â­â˜† | IPC å®‰å…¨ï¼Œåˆ é™¤ä¿æŠ¤æœºåˆ¶å®Œå–„ |
| ä¾èµ–ç®¡ç† | â­â­â­â­â˜† | ä¾èµ–ç‰ˆæœ¬è¾ƒæ–°ï¼Œæœ‰è¡¥ä¸å¤„ç† |
| æµ‹è¯•è¦†ç›– | â­â­â˜†â˜†â˜† | ç¼ºå°‘è‡ªåŠ¨åŒ–æµ‹è¯• |
| æ–‡æ¡£å®Œæ•´æ€§ | â­â­â­â˜†â˜† | README å’Œ RELEASE_NOTES å®Œå–„ï¼Œç¼ºå°‘ API æ–‡æ¡£ |
| é…ç½®ç®¡ç† | â­â­â­â­â˜† | é…ç½®æ–‡ä»¶å®Œæ•´ï¼Œå¤šå¹³å°æ”¯æŒ |
| æ€§èƒ½ä¼˜åŒ– | â­â­â­â­â˜† | åŸºç¡€ä¼˜åŒ–åˆ°ä½ |
| å›½é™…åŒ– | â­â­â­â­â˜† | ä¸­è‹±æ–‡åŒè¯­å®Œæ•´ |

### 11.2 æ€»ä½“è¯„åˆ†

```
â­â­â­â­â˜† (3.75/5)
```

**é¡¹ç›®æ•´ä½“è¯„ä»·**ï¼š

Claude-Cowork æ˜¯ä¸€ä¸ªæ¶æ„æ¸…æ™°ã€ä»£ç è´¨é‡è‰¯å¥½çš„ Electron æ¡Œé¢åº”ç”¨ã€‚é¡¹ç›®åœ¨å®‰å…¨æ€§ã€æ¶æ„è®¾è®¡æ–¹é¢è¡¨ç°ä¼˜ç§€ï¼Œåˆ é™¤æ“ä½œä¿æŠ¤æœºåˆ¶è®¾è®¡å®Œå–„ã€‚ä¸»è¦æ”¹è¿›ç©ºé—´åœ¨äºæ·»åŠ è‡ªåŠ¨åŒ–æµ‹è¯•å’Œè¡¥å……æŠ€æœ¯æ–‡æ¡£ã€‚

---

## åäºŒã€ä¼˜å…ˆçº§æ”¹è¿›å»ºè®®

### 12.1 é«˜ä¼˜å…ˆçº§ (ğŸ”´)

#### 1. æ·»åŠ å•å…ƒæµ‹è¯•

**ç›®æ ‡**ï¼šæ ¸å¿ƒæ¨¡å—æµ‹è¯•è¦†ç›–ç‡è¾¾åˆ° 60%+

**å®æ–½æ­¥éª¤**ï¼š

1. å®‰è£… Vitestï¼š
   ```bash
   bun add -D vitest @vitest/ui
   ```

2. é…ç½® vitest.config.tsï¼š
   ```typescript
   import { defineConfig } from 'vitest/config';

   export default defineConfig({
       test: {
           globals: true,
           environment: 'node',
       },
   });
   ```

3. ç¼–å†™æ ¸å¿ƒæ¨¡å—æµ‹è¯•

**é¢„æœŸæ”¶ç›Š**ï¼š
- å‡å°‘å›å½’ Bug
- æé«˜ä»£ç é‡æ„ä¿¡å¿ƒ
- æ”¹å–„ä»£ç è´¨é‡

#### 2. æ¸…ç†ç”Ÿäº§ç¯å¢ƒçš„ console.log

**ç›®æ ‡**ï¼šç§»é™¤æˆ–æ›¿æ¢æ‰€æœ‰ console è¾“å‡º

**å®æ–½æ–¹æ¡ˆ**ï¼š

| å½“å‰ | å»ºè®® |
|------|------|
| `console.log()` | `log.debug()` |
| `console.error()` | `log.error()` |
| `console.info()` | `log.info()` |

**å®æ–½ä½ç½®**ï¼š
- [src/ui/App.tsx](../src/ui/App.tsx)
- [src/electron/libs/util.ts](../src/electron/libs/util.ts)
- [src/electron/libs/config-store.ts](../src/electron/libs/config-store.ts)

#### 3. è¡¥å…… docs/ æŠ€æœ¯æ–‡æ¡£

**ç›®æ ‡**ï¼šå»ºç«‹å®Œæ•´çš„é¡¹ç›®æ–‡æ¡£ä½“ç³»

**éœ€è¦åˆ›å»ºçš„æ–‡æ¡£**ï¼š

1. `docs/03-APIæ–‡æ¡£/IPCäº‹ä»¶åˆ—è¡¨.md`
2. `docs/02-æŠ€æœ¯æ–‡æ¡£/æ¶æ„è®¾è®¡.md`
3. `docs/02-æŠ€æœ¯æ–‡æ¡£/å¼€å‘æŒ‡å—.md`

### 12.2 ä¸­ä¼˜å…ˆçº§ (ğŸŸ¡)

#### 4. åŠ å¼ºè¾“å…¥éªŒè¯

**ä½ç½®**ï¼š[config-store.ts:21](../src/electron/libs/config-store.ts#L21)

```typescript
// å»ºè®®æ·»åŠ æ›´ä¸¥æ ¼çš„éªŒè¯
function validateApiConfig(config: ApiConfig): void {
    // API Key æ ¼å¼éªŒè¯
    if (!/^sk-ant-[a-zA-Z0-9_-]+$/.test(config.apiKey)) {
        throw new Error('Invalid API Key format');
    }

    // URL æ ¼å¼éªŒè¯
    try {
        new URL(config.baseURL);
    } catch {
        throw new Error('Invalid Base URL');
    }
}
```

#### 5. æ·»åŠ è™šæ‹Ÿæ»šåŠ¨

**ç›®æ ‡**ï¼šæ”¯æŒå¤§æ¶ˆæ¯åˆ—è¡¨çš„é«˜æ€§èƒ½æ¸²æŸ“

**æ¨èåº“**ï¼š`react-window` æˆ– `react-virtual`

#### 6. å®šæœŸä¾èµ–å®‰å…¨æ‰«æ

**å‘½ä»¤**ï¼š
```bash
bun audit
npm audit
```

**å»ºè®®**ï¼šé›†æˆåˆ° CI/CD æµç¨‹ä¸­

### 12.3 ä½ä¼˜å…ˆçº§ (ğŸŸ¢)

#### 7. ä»£ç åˆ†å‰²

**ç›®æ ‡**ï¼šå‡å°‘åˆå§‹åŒ…å¤§å°

**å®æ–½æ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨ React.lazy() æ‡’åŠ è½½ç»„ä»¶
- è·¯ç”±çº§åˆ«çš„ä»£ç åˆ†å‰²

#### 8. æ·»åŠ  CSP å¤´

**ä½ç½®**ï¼š[main.ts:74](../src/electron/main.ts#L74)

```typescript
mainWindow = new BrowserWindow({
    // ...
    webPreferences: {
        webSecurity: true,
        preload: getPreloadPath(),
    }
});

mainWindow.session.webRequest.onHeadersReceived((details, callback) => {
    callback({
        responseHeaders: {
            ...details.responseHeaders,
            'Content-Security-Policy': ["default-src 'self'"]
        }
    });
});
```

#### 9. React é”™è¯¯è¾¹ç•Œ

**åˆ›å»º** `src/ui/components/ErrorBoundary.tsx`

```typescript
class ErrorBoundary extends React.Component {
    state = { hasError: false };

    static getDerivedStateFromError(error) {
        return { hasError: true };
    }

    componentDidCatch(error, errorInfo) {
        log.error('React Error Boundary', error, errorInfo);
    }

    render() {
        if (this.state.hasError) {
            return <h1>å‡ºé”™äº†ï¼Œè¯·åˆ·æ–°é¡µé¢ã€‚</h1>;
        }
        return this.props.children;
    }
}
```

---

## é™„å½•

### A. å…³é”®æ–‡ä»¶ç´¢å¼•

| æ–‡ä»¶è·¯å¾„ | ç”¨é€” | é‡è¦æ€§ |
|----------|------|--------|
| [src/electron/main.ts](../src/electron/main.ts) | Electron ä¸»è¿›ç¨‹å…¥å£ | â­â­â­â­â­ |
| [src/electron/libs/runner.ts](../src/electron/libs/runner.ts) | Claude AI ä»»åŠ¡è¿è¡Œå™¨ | â­â­â­â­â­ |
| [src/electron/libs/session-store.ts](../src/electron/libs/session-store.ts) | ä¼šè¯å­˜å‚¨ç®¡ç† | â­â­â­â­â­ |
| [src/electron/ipc-handlers.ts](../src/electron/ipc-handlers.ts) | IPC äº‹ä»¶å¤„ç† | â­â­â­â­â˜† |
| [src/ui/App.tsx](../src/ui/App.tsx) | ä¸»åº”ç”¨ç»„ä»¶ | â­â­â­â­â­ |
| [src/ui/store/useAppStore.ts](../src/ui/store/useAppStore.ts) | çŠ¶æ€ç®¡ç† | â­â­â­â­â˜† |

### B. æŠ€æœ¯æ ˆç‰ˆæœ¬æ±‡æ€»

```
Electron: 39.2.7
React: 19.2.3
TypeScript: 5.9.3
Vite: 7.3.1
Tailwind CSS: 4.1.18
Zustand: 5.0.10
better-sqlite3: 12.6.0
```

### C. ç›¸å…³é“¾æ¥

- [Claude Code å®˜æ–¹æ–‡æ¡£](https://docs.anthropic.com/en/docs/claude-code)
- [Electron æ–‡æ¡£](https://www.electronjs.org/docs)
- [React æ–‡æ¡£](https://react.dev)
- [Zustand æ–‡æ¡£](https://zustand-demo.pmnd.rs)

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2026-01-20
**å®¡è®¡å·¥å…·**: Claude Code
**å®¡è®¡äººå‘˜**: Alan
**ä¸‹æ¬¡å®¡è®¡å»ºè®®**: v0.2.0 å‘å¸ƒå‰
